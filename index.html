<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>milestone_five_monica_pagan</title>
  <link rel="stylesheet" href="https://stackedit.io/style.css" />
</head>

<body class="stackedit">
  <div class="stackedit__html"><h2 id="spatial-database-design-tutorial-using-crime-data">Spatial Database Design Tutorial using Crime Data</h2>
<p>This tutorial will help you get started in creating your very own database. This database will focus primarily on crime within the city of Philadelphia, Pennsylvania and will utilize both police station and police district boundaries data for the City of Philadelphia.</p>
<p>For this tutorial, you will work with the following datasets:</p>
<p><strong>Crime</strong>:</p>
<blockquote>
<p><a href="https://www.opendataphilly.org/dataset/crime-incidents">https://www.opendataphilly.org/dataset/crime-incidents</a></p>
</blockquote>
<p><strong>Police Stations</strong>:</p>
<blockquote>
<p><a href="https://www.opendataphilly.org/dataset/police-stations">https://www.opendataphilly.org/dataset/police-stations</a></p>
</blockquote>
<p><strong>Police boundaries</strong>:</p>
<blockquote>
<p><a href="https://www.opendataphilly.org/dataset/police-districts">https://www.opendataphilly.org/dataset/police-districts</a></p>
</blockquote>
<p>All three data sets are available in  <a href="http://OpenDataPhilly.com">OpenDataPhilly.com</a> and are downloadable for the public to view, access and  use.</p>
<p>These data sets can be imported into QGIS and accessed through the browser panel. These files can now be toggled on and off to view each data set as an individual layer.</p>
<p>The crime data will be downloaded as <strong>incidents_part1_part2</strong>  and contains some of the following attributes:</p>
<ul>
<li><strong>point_y</strong>- this refers to the point y data</li>
<li><strong>objectid</strong>- objects numbers in the data set</li>
<li><strong>dc_dist</strong>- describes the district boundary</li>
<li><strong>psa</strong>- police service area boundary</li>
<li><strong>dispatch_d</strong>- date that the officer was dispatched to the crime</li>
<li><strong>dispatch_1</strong>- this is also a dispatch date</li>
<li><strong>hour_</strong>- the generalized hour of the crime</li>
<li><strong>location_b</strong>- the generalized location of the crime by block</li>
<li><strong>ucr_genera</strong>- the rounded crime code for a particular crime</li>
<li><strong>text_gener</strong>- the text of the crime that was committed</li>
<li><strong>point_x</strong>- this refers to the point x data</li>
<li><strong>dispatch_t</strong>- this refers to the dispatch time</li>
<li><strong>DC_Key</strong>- the unique identifier of the crime which is made of the year, district, unique ID.</li>
</ul>
<p><strong>police_stations</strong>:</p>
<ul>
<li><strong>objectid</strong>- objects numbers in the data set</li>
<li><strong>district_n</strong>- police district</li>
<li><strong>location</strong>- the location of the police station</li>
<li><strong>telephone_</strong>- the telephone number of the police station</li>
<li><strong>ruleid</strong>- a representation rule to symbolize the features of the class</li>
</ul>
<p><strong>boundaries_district</strong>:</p>
<ul>
<li><strong>gis_police</strong>- this had no information on the metadata and also appeared with zeros</li>
<li><strong>perimeter</strong>- this gave the perimeter of each district</li>
<li><strong>district_</strong>-  this gives the district numbers each police boundary</li>
<li><strong>district_i</strong>- this gives the district numbers each police boundary</li>
<li><strong>dist_num</strong>- this gives the district numbers each police boundary</li>
<li><strong>sum_area</strong>- the area for each police boundary</li>
<li><strong>dist_numc</strong>- this gives the district numbers each police boundary</li>
<li><strong>location</strong>- this is the location for each police boundary</li>
<li><strong>phone</strong>- phone number provided for the district</li>
<li><strong>div_code</strong>- division code for the district</li>
<li><strong>area_sqmi</strong>- area in square miles for each district</li>
<li><strong>shape_leng</strong>- shape length for each district</li>
<li><strong>shape_area</strong>- shape area for each district</li>
</ul>
<p>Once your data are loaded into QGIS, you’ll want to next manage the data into a database using DBeaver which is a free and open-source relational database system that lets you connect and create servers. DBeaver manages data through PostgreSQL, which uses the coding language of SQL . For this tutorial, connect a database connection called <strong>philadelphia</strong> and is connected to a port that was available on this computer. This will be explained further below. This database is created through the following code in DBeaver:</p>
<pre class=" language-sql"><code class="prism  language-sql"><span class="token keyword">drop</span> <span class="token keyword">database</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> philadelphia<span class="token punctuation">;</span>
<span class="token keyword">create</span> <span class="token keyword">database</span> philadelphia<span class="token punctuation">;</span>
</code></pre>
<p>The next step was to create a schema within the database called <strong>philadelphia</strong>. This was done by right clicking on the database and selecting <strong>Create &gt; Schema</strong>. The schema name is then named <strong>philadelphia</strong>. This is where the information will be stored from QGIS. Afterwards make sure to run the following code in DBeaver:</p>
<pre class=" language-sql"><code class="prism  language-sql"><span class="token keyword">create</span> extension postgis<span class="token punctuation">;</span>
</code></pre>
<p>This extension will help the geometries to come over properly from the application QGIS. When in QGIS, an individual can move these shapefiles over to PostgreSQL. This can be done through the Database tab at the top right.</p>
<p>An individual will then click on DB Manager and connect to the database that they have created for this particular project. They then need to connect to the service that they have, which in this case is PostgreSQL. PostgreSQL can support these geographic objects as they are moved into the database. Sometimes connecting to a database may require having a username and password so it is important to have these pulled up somewhere.  After entering in this information, you need to select the <strong>philadelphia</strong> database. You can then connect and begin to move the shapefiles over.</p>
<p>After connecting to the <strong>philadelphia database</strong>, it is important to select the <strong>philadelphia schema</strong>, and from here click on the import button. Here it gives you the option to import the vector layer and input any of the layers that you currently have listed in your map both seen and unseen. From here you will select the layer incidents_part1_part2. For the schema, <strong>philadelphia</strong> should be selected and for table, as seen in the image below. Make sure to copy over incidents_part1_part2. Next you should check off the box for both a “geometry column” as well as “convert field names to lowercase”.  Make sure to name this table “incident_part1_part2”. Click okay and wait for about 10 to 20 minutes, as this file is large and should take a while to load into your database. Afterwards, bring the data over for police stations, and name this table “police_tp” making sure to put the table name in lower case. Repeat this same process for Philadelphia police boundaries naming this table “phillypolice_boundaries_district”. Check off the boxes “geometry column” and “convert field names to lowercase” for both of these files as well. After waiting a few minutes to make sure that each has been processed, open up DBeaver and check to ensure that the data has been successfully brought over to your database in each table. You may need to right click on the database and hit refresh. It should then appear. For the crime data there should be 2,664,247. The pictures of this process can be viewed below. After completing this process, this can all be checked by running the following code:</p>
<pre class=" language-sql"><code class="prism  language-sql"><span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> phillypolice_boundaries_district<span class="token punctuation">;</span>

<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> police_tp<span class="token punctuation">;</span>

<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> incidents_part1_part2

<span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token keyword">from</span> incidents_part1_part2<span class="token punctuation">;</span>
</code></pre>
<p><img src="https://github.com/monica-pagan/images/blob/gh-pages/philadelphia%20connected.png?raw=true" alt="enter image description here"></p>
<p><img src="https://github.com/monica-pagan/images/blob/gh-pages/importing%20layers.png?raw=true" alt="enter image description here"></p>
<p><img src="https://github.com/monica-pagan/images/blob/gh-pages/saving%20imported%20data.png?raw=true" alt="enter image description here"></p>
<p><img src="https://github.com/monica-pagan/images/blob/gh-pages/imported%20data%20successful.png?raw=true" alt="enter image description here"></p>
<p>The <strong>phillypolice_boundaries_district</strong> data has integer, varchar, and geom data. This data had excess information such as x and y data as well as the area_sqmi, dist_numc, sum_area, dist_num, dist_i, perimeter, and area. Many of these were repetitions of the column district_ and the perimeter, area_sqmi, sum_area and area could be calculated in the geom. These columns were eliminated through the creation of a new table called <strong>philadelphia_police_boundaries</strong>. This was created through a create table statement and then through the exchange transform load process, or ETL process. These excess columns were then eliminated and only the core columns were kept. This information was then used specifically for police boundaries. This can be seen in the following code:</p>
<pre class=" language-sql"><code class="prism  language-sql"><span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> philadelphia_police_boundaries <span class="token keyword">CASCADE</span><span class="token punctuation">;</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> philadelphia_police_boundaries <span class="token punctuation">(</span>
police_dist_id <span class="token keyword">int</span> <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">,</span>
district <span class="token keyword">int</span><span class="token punctuation">,</span>
location <span class="token keyword">varchar</span><span class="token punctuation">,</span>
geom <span class="token keyword">geometry</span><span class="token punctuation">,</span>
phone <span class="token keyword">varchar</span><span class="token punctuation">,</span>
div_code <span class="token keyword">varchar</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">insert</span>  <span class="token keyword">into</span> philadelphia_police_boundaries
<span class="token punctuation">(</span>police_dist_id<span class="token punctuation">,</span> geom<span class="token punctuation">,</span> district<span class="token punctuation">,</span> location<span class="token punctuation">,</span> phone<span class="token punctuation">,</span> div_code<span class="token punctuation">)</span>
<span class="token keyword">select</span>
id :: <span class="token keyword">int</span><span class="token punctuation">,</span>
geom :: <span class="token keyword">geometry</span><span class="token punctuation">,</span>
district_ :: <span class="token keyword">int</span><span class="token punctuation">,</span>
location :: <span class="token keyword">varchar</span><span class="token punctuation">,</span>
phone :: <span class="token keyword">varchar</span><span class="token punctuation">,</span>
div_code :: <span class="token keyword">varchar</span>
<span class="token keyword">from</span>
phillypolice_boundaries_district<span class="token punctuation">;</span>
</code></pre>
<p>The <strong>incidents_part1_part2</strong> table contains data such as integers, geom, date, and varchar. This data set also held a lot of excess information such as repetitive times and dates, as well as excess x and y data. When creating the new table <strong>crime_incident</strong> which gets all of the data from the <strong>incidents_part1_part2</strong> through the exchange transform load process, or ETL process, this excess information was left out to create a simpler table. There also needed to be updates on the districts because previous districts had been added together. These old districts that were updated were preserved through a separate table that was created called “crime_districts”. A <strong>ucr_text_genera</strong> table was also created in order to show the type of crimes that were being committed along with the code for each crime. The <strong>crime_incident</strong> table focused primarily on the crimes that were being committed while the <strong>ucr_text_genera</strong> table focused on the names of the crimes. The <strong>crime_districts</strong> contained the old districts that were used before update. These tables were created through the following:</p>
<pre class=" language-sql"><code class="prism  language-sql"><span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> crime_incident <span class="token keyword">CASCADE</span><span class="token punctuation">;</span>
<span class="token keyword">create</span>  <span class="token keyword">table</span> crime_incident <span class="token punctuation">(</span>
dc_key <span class="token keyword">varchar</span>  <span class="token keyword">primary</span>  <span class="token keyword">key</span><span class="token punctuation">,</span>
police_dist_id <span class="token keyword">int</span> <span class="token keyword">references</span> philadelphia_police_boundaries<span class="token punctuation">(</span>police_dist_id<span class="token punctuation">)</span><span class="token punctuation">,</span>
crime_id <span class="token keyword">integer</span><span class="token punctuation">,</span>
crime_dist <span class="token keyword">integer</span><span class="token punctuation">,</span>
psa <span class="token keyword">varchar</span><span class="token punctuation">,</span>
crime_location <span class="token keyword">varchar</span><span class="token punctuation">,</span>
dispatch_date <span class="token keyword">date</span><span class="token punctuation">,</span>
dispatch_time <span class="token keyword">varchar</span><span class="token punctuation">,</span>
geom <span class="token keyword">geometry</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">insert</span> <span class="token keyword">into</span> crime_incident
<span class="token punctuation">(</span>dc_key<span class="token punctuation">,</span> police_dist_id<span class="token punctuation">,</span> crime_id<span class="token punctuation">,</span> crime_dist<span class="token punctuation">,</span> psa<span class="token punctuation">,</span> crime_location<span class="token punctuation">,</span> dispatch_date<span class="token punctuation">,</span> dispatch_time<span class="token punctuation">,</span> geom<span class="token punctuation">)</span>
<span class="token keyword">select</span>
dc_key :: <span class="token keyword">varchar</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> police_dist_id
<span class="token keyword">from</span> philadelphia_police_boundaries <span class="token keyword">as</span> <span class="token number">c</span>
<span class="token keyword">where</span> <span class="token number">c</span><span class="token punctuation">.</span>district <span class="token operator">=</span> <span class="token number">d</span><span class="token punctuation">.</span>dc_dist :: <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
id :: <span class="token keyword">integer</span><span class="token punctuation">,</span>
dc_dist :: <span class="token keyword">integer</span><span class="token punctuation">,</span>
psa :: <span class="token keyword">varchar</span><span class="token punctuation">,</span>
location_b :: <span class="token keyword">varchar</span><span class="token punctuation">,</span>
dispatch_d :: <span class="token keyword">date</span><span class="token punctuation">,</span>
dispatch_t :: <span class="token keyword">varchar</span><span class="token punctuation">,</span>
geom :: <span class="token keyword">geometry</span>
<span class="token keyword">from</span>
incidents_part1_part2 <span class="token keyword">as</span> <span class="token number">d</span><span class="token punctuation">;</span>

<span class="token keyword">UPDATE</span> crime_incident
<span class="token keyword">SET</span> crime_dist <span class="token operator">=</span> <span class="token string">'16'</span>
<span class="token keyword">WHERE</span> crime_dist <span class="token operator">=</span> <span class="token string">'92'</span><span class="token punctuation">;</span>

<span class="token keyword">UPDATE</span> crime_incident
<span class="token keyword">SET</span> crime_dist <span class="token operator">=</span> <span class="token string">'3'</span>
<span class="token keyword">WHERE</span> crime_dist <span class="token operator">=</span> <span class="token string">'4'</span><span class="token punctuation">;</span>

<span class="token keyword">UPDATE</span> crime_incident
<span class="token keyword">SET</span> crime_dist <span class="token operator">=</span> <span class="token string">'22'</span>
<span class="token keyword">WHERE</span> crime_dist <span class="token operator">=</span> <span class="token string">'23'</span><span class="token punctuation">;</span>

<span class="token keyword">insert</span> <span class="token keyword">into</span> crime_districts
<span class="token punctuation">(</span>dc_key<span class="token punctuation">,</span> crime_district<span class="token punctuation">)</span>
<span class="token keyword">select</span>
dc_key :: <span class="token keyword">bigint</span><span class="token punctuation">,</span>
dc_dist :: <span class="token keyword">int</span>
<span class="token keyword">from</span>
incidents_part1_part2 <span class="token keyword">as</span> <span class="token number">d</span><span class="token punctuation">;</span>

<span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> ucr_text_genera <span class="token keyword">CASCADE</span><span class="token punctuation">;</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> ucr_text_genera <span class="token punctuation">(</span>
dc_key <span class="token keyword">varchar</span> <span class="token keyword">references</span> crime_incident<span class="token punctuation">(</span>dc_key<span class="token punctuation">)</span><span class="token punctuation">,</span>
ucr_id <span class="token keyword">serial</span> <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">,</span>
ucr_genera <span class="token keyword">varchar</span><span class="token punctuation">,</span>
text_gener <span class="token keyword">varchar</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">insert</span> <span class="token keyword">into</span> ucr_text_genera
<span class="token punctuation">(</span>dc_key<span class="token punctuation">,</span> ucr_genera<span class="token punctuation">,</span> text_gener<span class="token punctuation">)</span>
<span class="token keyword">select</span>
dc_key :: <span class="token keyword">bigint</span><span class="token punctuation">,</span>
ucr_genera :: <span class="token keyword">varchar</span><span class="token punctuation">,</span>
text_gener :: <span class="token keyword">varchar</span>
<span class="token keyword">from</span>
incidents_part1_part2<span class="token punctuation">;</span>
</code></pre>
<p>Within the <strong>police_tp</strong> data there was also integers, geom, and varchar data. Information that needed to be condensed included rule_id, x_coordina and y_coordina. These columns were excluded when the table <strong>police_station</strong> was created. This can be created through the code that is listed below. Within the police data there was also excess information. This was also condensed through the ETL process having only the columns that were needed and leaving out the columns that were unnecessary. The <strong>police_station</strong> data also needed to be updated because there was a station 77 that was not listed before. This information needed to be put in by hand. This was updated through following the code:</p>
<pre class=" language-sql"><code class="prism  language-sql">
<span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> police_station <span class="token keyword">CASCADE</span><span class="token punctuation">;</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> police_station <span class="token punctuation">(</span>
district_neighborhoods <span class="token keyword">int</span><span class="token punctuation">,</span>
police_dist_id <span class="token keyword">int</span> <span class="token keyword">references</span> philadelphia_police_boundaries<span class="token punctuation">(</span>police_dist_id<span class="token punctuation">)</span><span class="token punctuation">,</span>
station_id <span class="token keyword">integer</span> <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">,</span>
geom <span class="token keyword">geometry</span><span class="token punctuation">,</span>
locationvarchar<span class="token punctuation">,</span>
telephone <span class="token keyword">varchar</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">insert</span> <span class="token keyword">into</span> police_station
<span class="token punctuation">(</span>district_neighborhoods<span class="token punctuation">,</span> geom<span class="token punctuation">,</span> station_id<span class="token punctuation">,</span> location<span class="token punctuation">,</span> telephone<span class="token punctuation">,</span> police_dist_id<span class="token punctuation">)</span>
<span class="token keyword">select</span>
<span class="token string">'77'</span><span class="token punctuation">,</span> <span class="token string">'MULTIPOINT ((-75.13396 40.00764))'</span><span class="token punctuation">,</span> <span class="token string">'25'</span><span class="token punctuation">,</span> <span class="token string">'Departures Rd'</span><span class="token punctuation">,</span> <span class="token string">'937-6918'</span><span class="token punctuation">,</span> <span class="token string">'15'</span><span class="token punctuation">;</span>

<span class="token keyword">insert</span> <span class="token keyword">into</span> police_station
<span class="token punctuation">(</span>district_neighborhoods<span class="token punctuation">,</span> geom<span class="token punctuation">,</span> station_id<span class="token punctuation">,</span> location<span class="token punctuation">,</span> telephone<span class="token punctuation">,</span> police_dist_id<span class="token punctuation">)</span>
<span class="token keyword">select</span>
district_n :: <span class="token keyword">int</span><span class="token punctuation">,</span>
geom :: <span class="token keyword">geometry</span><span class="token punctuation">,</span>
objectid :: <span class="token keyword">int</span><span class="token punctuation">,</span>
location :: <span class="token keyword">varchar</span><span class="token punctuation">,</span>
telephone_ :: <span class="token keyword">varchar</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> police_dist_id
<span class="token keyword">from</span> philadelphia_police_boundaries <span class="token keyword">as</span> <span class="token number">c</span>
<span class="token keyword">where</span> <span class="token number">c</span><span class="token punctuation">.</span>district <span class="token operator">=</span> <span class="token number">d</span><span class="token punctuation">.</span>district_n<span class="token punctuation">)</span>
<span class="token keyword">from</span>
police_tp <span class="token keyword">as</span> <span class="token number">d</span><span class="token punctuation">;</span>

<span class="token keyword">insert</span> <span class="token keyword">into</span> police_station
<span class="token punctuation">(</span>district_neighborhoods<span class="token punctuation">,</span> geom<span class="token punctuation">,</span> station_id<span class="token punctuation">,</span> location<span class="token punctuation">,</span> telephone<span class="token punctuation">,</span> police_dist_id<span class="token punctuation">)</span>
<span class="token keyword">select</span>
district_n :: <span class="token keyword">int</span><span class="token punctuation">,</span>
geom :: <span class="token keyword">geometry</span><span class="token punctuation">,</span>
objectid :: <span class="token keyword">int</span><span class="token punctuation">,</span>
location :: <span class="token keyword">varchar</span><span class="token punctuation">,</span>
telephone_ :: <span class="token keyword">varchar</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> police_dist_id
<span class="token keyword">from</span> philadelphia_police_boundaries <span class="token keyword">as</span> <span class="token number">c</span>
<span class="token keyword">where</span> <span class="token number">c</span><span class="token punctuation">.</span>district <span class="token operator">=</span> <span class="token number">d</span><span class="token punctuation">.</span>district_n<span class="token punctuation">)</span>
<span class="token keyword">from</span> police_tp <span class="token keyword">as</span> <span class="token number">d</span><span class="token punctuation">;</span>
</code></pre>
<p>An Entity Relationship Diagram or ERD was created for these tables showing that there is a relationship between these tables. This diagram shows a one to many relationship or a one to one relationship through lines and crows feet. This is visible on the following diagram:</p>
<p><img src="https://github.com/monica-pagan/images/blob/gh-pages/philadelphia_ERD.png?raw=true" alt="enter image description here"></p>
<p>After ensuring that each of the data sets are present and accounted for, questions can then be asked by the user and answered by the data. A spatial questions that can be analyzed with this data is does police station 12 have robberies being committed? We can also ask analytical questions. Let’s construct code and use functions to get the for the following three questions:</p>
<ol>
<li>Which crime location has the most thefts and at what time?<br>
*This questions analyzes which police stations sends out the most dispatches for the total number of thefts being committed at a particular location. This utilizes both the <strong>ucr_text_genera</strong> table as well as the **crime_incident *<em>table. In order for this question to be answered fully, a join must be completed on two tables in order for the crime_location data to be available as well as the text_gener data. A where statement is added in order for the text_gener to include only thefts. A group by statement is also included as well as an order by descending and a limit clause to help limit how many results will be coming back.</em></li>
</ol>
<pre class=" language-sql"><code class="prism  language-sql"><span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span>crime_location<span class="token punctuation">)</span><span class="token punctuation">,</span> crime_location<span class="token punctuation">,</span> dispatch_time<span class="token punctuation">,</span> text_gener
<span class="token keyword">from</span> crime_incident <span class="token keyword">as</span> <span class="token number">c</span>
<span class="token keyword">join</span>
ucr_text_genera <span class="token keyword">as</span> <span class="token number">d</span>
<span class="token keyword">on</span> <span class="token number">c</span><span class="token punctuation">.</span>dc_key <span class="token operator">=</span> <span class="token number">d</span><span class="token punctuation">.</span>dc_key
<span class="token keyword">where</span> text_gener <span class="token operator">like</span> <span class="token string">'Thefts%'</span>
<span class="token keyword">group</span> <span class="token keyword">by</span> crime_location<span class="token punctuation">,</span> dispatch_time<span class="token punctuation">,</span> text_gener
<span class="token keyword">order</span> <span class="token keyword">by</span> count <span class="token keyword">desc</span>
<span class="token keyword">limit</span> <span class="token number">1</span><span class="token punctuation">;</span>
</code></pre>
<p><strong>Results</strong></p>
<pre class=" language-sql"><code class="prism  language-sql">count<span class="token operator">|</span>crime_location      <span class="token operator">|</span>dispatch_time<span class="token operator">|</span>text_gener<span class="token operator">|</span>
<span class="token comment">-----|--------------------|-------------|----------|</span>
   <span class="token number">18</span><span class="token operator">|</span><span class="token number">1000</span> BLOCK MARKET ST<span class="token operator">|</span><span class="token number">13</span>:<span class="token number">38</span>:<span class="token number">00</span>     <span class="token operator">|</span>Thefts    <span class="token operator">|</span>
</code></pre>
<ol start="2">
<li>Information for two of the police stations is hard to find. You need to find the division codes but all you have is the phone number ‘686-3050’ from the philadelphia_police_boundaries and the police district id 15. Find out the division codes of these police districts as well as their station id. This will require a join.<br>
<em>This question is trying to find the division code of each of these stations as well as the station id with the limited amount of information that is given to the user.  This requires for there to be one join on both the <strong>police_station</strong> table as well as the <strong>philadelphia_police_boundaries</strong> table. This is needed because the columns div_code and phone are from the <strong>philadelphia_police_boundaries</strong> table while the station_id column is from the <strong>police_station</strong> table. A where statement is used for the police_dist_id as well as for the phone number. An OR operator is used here so that the query can return both results. This gives us the result we are looking for.</em></li>
</ol>
<pre class=" language-sql"><code class="prism  language-sql"><span class="token keyword">select</span> div_code<span class="token punctuation">,</span> phone<span class="token punctuation">,</span> station_id
<span class="token keyword">from</span> police_station <span class="token keyword">as</span> <span class="token number">c</span>
<span class="token keyword">join</span>
philadelphia_police_boundaries <span class="token keyword">as</span> <span class="token number">d</span>
<span class="token keyword">on</span> <span class="token number">c</span><span class="token punctuation">.</span>police_dist_id <span class="token operator">=</span> <span class="token number">d</span><span class="token punctuation">.</span>police_dist_id
<span class="token keyword">where</span> <span class="token punctuation">(</span><span class="token number">c</span><span class="token punctuation">.</span>police_dist_id <span class="token operator">=</span> <span class="token number">15</span><span class="token punctuation">)</span> <span class="token operator">OR</span> <span class="token punctuation">(</span>phone <span class="token operator">=</span> <span class="token string">'686-3050'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p><strong>Results</strong></p>
<pre class=" language-sql"><code class="prism  language-sql">div_code<span class="token operator">|</span>phone   <span class="token operator">|</span>station_id<span class="token operator">|</span>
<span class="token comment">--------|--------|----------|</span>
SWPD    <span class="token operator">|</span><span class="token number">937</span><span class="token operator">-</span><span class="token number">6816</span><span class="token operator">|</span>        <span class="token number">25</span><span class="token operator">|</span>
NWPD    <span class="token operator">|</span><span class="token number">686</span><span class="token operator">-</span><span class="token number">3050</span><span class="token operator">|</span>         <span class="token number">7</span><span class="token operator">|</span>
</code></pre>
<ol start="3">
<li>Which police station id responded to the most arsons?Make sure to also show the police district specifically from the police_station table.<br>
<em>This question is analyzing which station id were dispatched to arsons in Philadelphia. This question is asking for the total number of arsons so it will be need a count function. Because of the nature of the question it will be using three joins on four tables. The <strong>police_station</strong> table is focused on the police stations and contains the station_id column which is necessary for this question. In order to get to this table, however, it is important to get to the <strong>philadelphia_police_boundaries</strong> table. This will be accessible through the <strong>crime_incident</strong> table which will give us the information leading to the <strong>ucr_text_genera</strong> table. From here we will be able to hone in on the arsons and use a where clause as well as a group by. An order by count desc will help query return the highest number of arsons in the police district we are looking for.</em></li>
</ol>
<pre class=" language-sql"><code class="prism  language-sql"><span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span>text_gener<span class="token punctuation">)</span><span class="token punctuation">,</span> text_gener<span class="token punctuation">,</span> <span class="token number">f</span><span class="token punctuation">.</span>police_dist_id<span class="token punctuation">,</span> station_id
<span class="token keyword">from</span> ucr_text_genera <span class="token keyword">as</span> <span class="token number">c</span> 
<span class="token keyword">join</span>
crime_incident <span class="token keyword">as</span> <span class="token number">d</span>
<span class="token keyword">on</span>  
<span class="token number">c</span><span class="token punctuation">.</span>dc_key <span class="token operator">=</span> <span class="token number">d</span><span class="token punctuation">.</span>dc_key
<span class="token keyword">join</span>
philadelphia_police_boundaries <span class="token keyword">as</span> <span class="token number">e</span>
<span class="token keyword">on</span>
<span class="token number">e</span><span class="token punctuation">.</span>police_dist_id <span class="token operator">=</span> <span class="token number">d</span><span class="token punctuation">.</span>police_dist_id
<span class="token keyword">join</span>
police_station <span class="token keyword">as</span> <span class="token number">f</span>
<span class="token keyword">on</span> <span class="token number">e</span><span class="token punctuation">.</span>police_dist_id <span class="token operator">=</span> <span class="token number">f</span><span class="token punctuation">.</span>police_dist_id
<span class="token keyword">where</span> text_gener <span class="token operator">like</span> <span class="token string">'Arson'</span>
<span class="token keyword">group</span> <span class="token keyword">by</span> text_gener<span class="token punctuation">,</span> <span class="token number">f</span><span class="token punctuation">.</span>police_dist_id<span class="token punctuation">,</span> station_id
<span class="token keyword">order</span> <span class="token keyword">by</span> count <span class="token keyword">desc</span>
<span class="token keyword">limit</span> <span class="token number">1</span><span class="token punctuation">;</span>
</code></pre>
<p><strong>Results</strong></p>
<pre class=" language-sql"><code class="prism  language-sql">count<span class="token operator">|</span>text_gener<span class="token operator">|</span>police_dist_id<span class="token operator">|</span>station_id<span class="token operator">|</span>
<span class="token comment">-----|----------|--------------|----------|</span>
  <span class="token number">685</span><span class="token operator">|</span>Arson     <span class="token operator">|</span>            <span class="token number">12</span><span class="token operator">|</span>         <span class="token number">9</span><span class="token operator">|</span>
</code></pre>
<p>Before creating the indexes, queries for the <strong>crime_incident</strong> table were taking much longer to pull up for information on the columns dc_key, crime_id, crime_location, dispatch_date, and dispatch_time. This is because there are over two million rows of information.  In order to solve this problem I created an index for <strong>crime_incident</strong> as well as the <strong>ucr_text_genera</strong> because both of these tables encountered the same problems. After creating the indexes there was a decrease in the time of looking up the information of the <strong>crime_incident</strong> table as well as the <strong>ucr_text_genera</strong> table. This helps speed up times for select statements as well as where clauses. This code can be found below:</p>
<pre class=" language-sql"><code class="prism  language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> crime_philadelphia
<span class="token keyword">ON</span> crime_incident <span class="token punctuation">(</span>dc_key<span class="token punctuation">,</span> crime_id<span class="token punctuation">,</span> crime_location<span class="token punctuation">,</span> dispatch_date<span class="token punctuation">,</span> dispatch_time<span class="token punctuation">,</span> crime_location<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<pre class=" language-sql"><code class="prism  language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> crime_types
<span class="token keyword">ON</span> ucr_text_genera <span class="token punctuation">(</span>dc_key<span class="token punctuation">,</span> ucr_genera<span class="token punctuation">,</span> text_gener<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>After creating these indexes see how quickly these question can be answered now and compare the times of before and after!</p>
<p>Appendix</p>
<p>I.</p>
<p>In order to create the tables, the shapefile data should be downloaded from <a href="https://www.opendataphilly.org/">https://www.opendataphilly.org/</a>.  This should be specifically from the public safety page which can be found here: <a href="http://opendataphilly.org/group/public-safety-group">opendataphilly.org/group/public-safety-group</a> . Once on this page, download the police districts shapefile which can be downloaded directly here: <a href="http://data.phl.opendata.arcgis.com/datasets/62ec63afb8824a15953399b1fa819df2_0.zip" title="http://data.phl.opendata.arcgis.com/datasets/62ec63afb8824a15953399b1fa819df2_0.zip">http://data.phl.opendata.arcgis.com/datasets/62ec63afb8824a15953399b1fa819df2_0.zip</a>. Make sure to download the police stations shapefile data as well at the following link:<br>
<a href="http://data.phl.opendata.arcgis.com/datasets/7e522339d7c24e8ea5f2c7780291c315_0.zip" title="http://data.phl.opendata.arcgis.com/datasets/7e522339d7c24e8ea5f2c7780291c315_0.zip">http://data.phl.opendata.arcgis.com/datasets/7e522339d7c24e8ea5f2c7780291c315_0.zip</a>. The crime shapefile data can be directly found  here: <a href="https://phl.carto.com/api/v2/sql?q=SELECT+*+FROM+incidents_part1_part2&amp;filename=incidents_part1_part2&amp;format=shp&amp;skipfields=cartodb_id" title="https://phl.carto.com/api/v2/sql?q=SELECT+*+FROM+incidents_part1_part2&amp;filename=incidents_part1_part2&amp;format=shp&amp;skipfields=cartodb_id">https://phl.carto.com/api/v2/sql?q=SELECT+*+FROM+incidents_part1_part2&amp;filename=incidents_part1_part2&amp;format=shp&amp;skipfields=cartodb_id</a>. From this link you should be able to download the incident_part1_part2 shapefile, but because it is a very large file it may take several minutes to download from the browser. This can then be moved to loaded onto QGIS and examined through the browser panel. You are then able to go through folders to whichever folder you have saved your data to. In this tutorial the data was saved in <strong>C:\ &gt; Users &gt; tuf91019 &gt; Spatial Database Design</strong>. These files can then be clicked on and off depending on if the user would like to view them or not.</p>
<p>II.</p>
<p>In order to get this information into new tables that are created, this information is pulled from the previous tables that are downloaded and brought over from QGIS. This can be done through the following code:</p>
<pre class=" language-sql"><code class="prism  language-sql"><span class="token comment">--create extension</span>

<span class="token keyword">create</span> extension postgis<span class="token punctuation">;</span>

<span class="token comment">--create the database</span>

<span class="token keyword">drop</span> <span class="token keyword">database</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> philadelphia<span class="token punctuation">;</span>
<span class="token keyword">create</span> <span class="token keyword">database</span> philadelphia<span class="token punctuation">;</span>

<span class="token comment">--create the philadelphia police district boundaries</span>

<span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> philadelphia_police_boundaries <span class="token keyword">CASCADE</span><span class="token punctuation">;</span> <span class="token comment">--formerly districts</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> philadelphia_police_boundaries <span class="token punctuation">(</span>
	police_dist_id <span class="token keyword">int</span> <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">,</span>
	district <span class="token keyword">int</span><span class="token punctuation">,</span>
	location <span class="token keyword">varchar</span><span class="token punctuation">,</span>
	geom <span class="token keyword">geometry</span><span class="token punctuation">,</span>
	phone <span class="token keyword">varchar</span><span class="token punctuation">,</span>
	div_code <span class="token keyword">varchar</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">insert</span> <span class="token keyword">into</span> philadelphia_police_boundaries
<span class="token punctuation">(</span>police_dist_id<span class="token punctuation">,</span> geom<span class="token punctuation">,</span> district<span class="token punctuation">,</span> location<span class="token punctuation">,</span> phone<span class="token punctuation">,</span> div_code<span class="token punctuation">)</span>
<span class="token keyword">select</span>
id :: <span class="token keyword">int</span><span class="token punctuation">,</span>
geom :: <span class="token keyword">geometry</span><span class="token punctuation">,</span>
district_ :: <span class="token keyword">int</span><span class="token punctuation">,</span>
location :: <span class="token keyword">varchar</span><span class="token punctuation">,</span>
phone :: <span class="token keyword">varchar</span><span class="token punctuation">,</span>
div_code :: <span class="token keyword">varchar</span>
<span class="token keyword">from</span>
phillypolice_boundaries_district<span class="token punctuation">;</span>

<span class="token comment">--create the police station tables</span>

<span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> police_station <span class="token keyword">CASCADE</span><span class="token punctuation">;</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> police_station <span class="token punctuation">(</span>
	district_neighborhoods <span class="token keyword">int</span><span class="token punctuation">,</span>
	police_dist_id <span class="token keyword">int</span> <span class="token keyword">references</span> philadelphia_police_districts<span class="token punctuation">(</span>police_dist_id<span class="token punctuation">)</span><span class="token punctuation">,</span>
	station_id <span class="token keyword">integer</span> <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">,</span>
	geom <span class="token keyword">geometry</span><span class="token punctuation">,</span>
	location <span class="token keyword">varchar</span><span class="token punctuation">,</span>
	telephone <span class="token keyword">varchar</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">insert</span> <span class="token keyword">into</span> police_station
<span class="token punctuation">(</span>district_neighborhoods<span class="token punctuation">,</span> geom<span class="token punctuation">,</span> station_id<span class="token punctuation">,</span> location<span class="token punctuation">,</span> telephone<span class="token punctuation">,</span> police_dist_id<span class="token punctuation">)</span>
<span class="token keyword">select</span>
<span class="token string">'77'</span><span class="token punctuation">,</span> <span class="token string">'MULTIPOINT ((-75.13396 40.00764))'</span><span class="token punctuation">,</span> <span class="token string">'25'</span><span class="token punctuation">,</span> <span class="token string">'Departures Rd'</span><span class="token punctuation">,</span> <span class="token string">'937-6918'</span><span class="token punctuation">,</span> <span class="token string">'15'</span><span class="token punctuation">;</span>

<span class="token keyword">insert</span> <span class="token keyword">into</span> police_station
<span class="token punctuation">(</span>district_neighborhoods<span class="token punctuation">,</span> geom<span class="token punctuation">,</span> station_id<span class="token punctuation">,</span> location<span class="token punctuation">,</span> telephone<span class="token punctuation">,</span> police_dist_id<span class="token punctuation">)</span>
<span class="token keyword">select</span>
district_n :: <span class="token keyword">int</span><span class="token punctuation">,</span>
geom :: <span class="token keyword">geometry</span><span class="token punctuation">,</span>
objectid :: <span class="token keyword">int</span><span class="token punctuation">,</span>
location :: <span class="token keyword">varchar</span><span class="token punctuation">,</span>
telephone_ :: <span class="token keyword">varchar</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> police_dist_id
<span class="token keyword">from</span> philadelphia_police_boundaries <span class="token keyword">as</span> <span class="token number">c</span>
<span class="token keyword">where</span> <span class="token number">c</span><span class="token punctuation">.</span>district <span class="token operator">=</span> <span class="token number">d</span><span class="token punctuation">.</span>district_n<span class="token punctuation">)</span>
<span class="token keyword">from</span>
police_tp <span class="token keyword">as</span> <span class="token number">d</span><span class="token punctuation">;</span>


<span class="token comment">--create the crime_incident tables and inserts</span>

<span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> crime_incident <span class="token keyword">CASCADE</span><span class="token punctuation">;</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> crime_incident <span class="token punctuation">(</span>
	dc_key <span class="token keyword">varchar</span> <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">,</span>
	police_dist_id <span class="token keyword">int</span> <span class="token keyword">references</span> philadelphia_police_boundaries<span class="token punctuation">(</span>police_dist_id<span class="token punctuation">)</span><span class="token punctuation">,</span>
	crime_id <span class="token keyword">integer</span><span class="token punctuation">,</span>
	crime_dist <span class="token keyword">integer</span><span class="token punctuation">,</span>
	psa <span class="token keyword">varchar</span><span class="token punctuation">,</span>
	crime_location <span class="token keyword">varchar</span><span class="token punctuation">,</span>
	dispatch_date <span class="token keyword">date</span><span class="token punctuation">,</span>
	dispatch_time <span class="token keyword">varchar</span><span class="token punctuation">,</span>
	geom <span class="token keyword">geometry</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">insert</span> <span class="token keyword">into</span> crime_incident
<span class="token punctuation">(</span>dc_key<span class="token punctuation">,</span> police_dist_id<span class="token punctuation">,</span> crime_id<span class="token punctuation">,</span> crime_dist<span class="token punctuation">,</span> psa<span class="token punctuation">,</span> crime_location<span class="token punctuation">,</span> dispatch_date<span class="token punctuation">,</span> dispatch_time<span class="token punctuation">,</span> geom<span class="token punctuation">)</span>
<span class="token keyword">select</span>
dc_key :: <span class="token keyword">varchar</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> police_dist_id
<span class="token keyword">from</span> philadelphia_police_boundaries <span class="token keyword">as</span> <span class="token number">c</span>
<span class="token keyword">where</span> <span class="token number">c</span><span class="token punctuation">.</span>district <span class="token operator">=</span> <span class="token number">d</span><span class="token punctuation">.</span>dc_dist :: <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
id :: <span class="token keyword">integer</span><span class="token punctuation">,</span>
dc_dist :: <span class="token keyword">integer</span><span class="token punctuation">,</span>
psa :: <span class="token keyword">varchar</span><span class="token punctuation">,</span>
location_b :: <span class="token keyword">varchar</span><span class="token punctuation">,</span>
dispatch_d :: <span class="token keyword">date</span><span class="token punctuation">,</span>
dispatch_t :: <span class="token keyword">varchar</span><span class="token punctuation">,</span>
geom :: <span class="token keyword">geometry</span>
<span class="token keyword">from</span>
incidents_part1_part2 <span class="token keyword">as</span> <span class="token number">d</span><span class="token punctuation">;</span>

<span class="token keyword">UPDATE</span> crime_incident
<span class="token keyword">SET</span> crime_dist <span class="token operator">=</span> <span class="token string">'16'</span>
<span class="token keyword">WHERE</span> crime_dist <span class="token operator">=</span> <span class="token string">'92'</span><span class="token punctuation">;</span>

<span class="token keyword">UPDATE</span> crime_incident
<span class="token keyword">SET</span> crime_dist <span class="token operator">=</span> <span class="token string">'3'</span>
<span class="token keyword">WHERE</span> crime_dist <span class="token operator">=</span> <span class="token string">'4'</span><span class="token punctuation">;</span>

<span class="token keyword">UPDATE</span> crime_incident
<span class="token keyword">SET</span> crime_dist <span class="token operator">=</span> <span class="token string">'22'</span>
<span class="token keyword">WHERE</span> crime_dist <span class="token operator">=</span> <span class="token string">'23'</span><span class="token punctuation">;</span>

<span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> crime_district <span class="token keyword">CASCADE</span><span class="token punctuation">;</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> crime_district <span class="token punctuation">(</span>
	dc_key <span class="token keyword">varchar</span> <span class="token keyword">references</span> crime_incident<span class="token punctuation">(</span>dc_key<span class="token punctuation">)</span><span class="token punctuation">,</span>
	crime_district_id <span class="token keyword">serial</span> <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">,</span>
	crime_district <span class="token keyword">int</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">insert</span> <span class="token keyword">into</span> crime_district
<span class="token punctuation">(</span>dc_key<span class="token punctuation">,</span> crime_district<span class="token punctuation">)</span>
<span class="token keyword">select</span>
dc_key :: <span class="token keyword">bigint</span><span class="token punctuation">,</span>
dc_dist :: <span class="token keyword">int</span>
<span class="token keyword">from</span>
incidents_part1_part2 <span class="token keyword">as</span> <span class="token number">d</span><span class="token punctuation">;</span>

<span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> ucr_text_genera <span class="token keyword">CASCADE</span><span class="token punctuation">;</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> ucr_text_genera <span class="token punctuation">(</span>
	dc_key <span class="token keyword">varchar</span> <span class="token keyword">references</span> crime_incident<span class="token punctuation">(</span>dc_key<span class="token punctuation">)</span><span class="token punctuation">,</span>
    ucr_id <span class="token keyword">serial</span> <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">,</span>
	ucr_genera <span class="token keyword">varchar</span><span class="token punctuation">,</span>
	text_gener <span class="token keyword">varchar</span>
	<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">insert</span> <span class="token keyword">into</span> ucr_text_genera
<span class="token punctuation">(</span>dc_key<span class="token punctuation">,</span> ucr_genera<span class="token punctuation">,</span> text_gener<span class="token punctuation">)</span>
<span class="token keyword">select</span>
dc_key :: <span class="token keyword">bigint</span><span class="token punctuation">,</span>
ucr_genera :: <span class="token keyword">varchar</span><span class="token punctuation">,</span>
text_gener :: <span class="token keyword">varchar</span>
<span class="token keyword">from</span>
incidents_part1_part2<span class="token punctuation">;</span>
</code></pre>
<p>III.<br>
After creating the ETL, creating an index for the <strong>crime_incident</strong> and the <strong>ucr_text_genera</strong> tables is the next step. This helps speed up queries through especially in the Select and Where clause.</p>
<pre class=" language-sql"><code class="prism  language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> crime_philadelphia
<span class="token keyword">ON</span> crime_incident <span class="token punctuation">(</span>dc_key<span class="token punctuation">,</span> crime_id<span class="token punctuation">,</span> crime_location<span class="token punctuation">,</span> dispatch_date<span class="token punctuation">,</span> dispatch_time<span class="token punctuation">,</span> crime_location<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<pre class=" language-sql"><code class="prism  language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> crime_types
<span class="token keyword">ON</span> ucr_text_genera <span class="token punctuation">(</span>dc_key<span class="token punctuation">,</span> ucr_genera<span class="token punctuation">,</span> text_gener<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>IV.<br>
The following information contains column information for each of the tables that have been added to the database.</p>
<p>The <strong>philadelphia_police_boundaries</strong> contains the following columns and information:</p>
<ul>
<li><strong>police_dist_id</strong>- this contains the primary key of the table</li>
<li><strong>district</strong>- this is the district of the boundary</li>
<li><strong>location</strong>- the location of the the boundaries</li>
<li><strong>geom</strong>- the geometry of each police boundary</li>
<li><strong>phone</strong> - the phone number of the police boundary</li>
<li><strong>div_code</strong>-division code for the district<br>
);</li>
</ul>
<p>This information describes the <strong>police_station</strong> table’s columns:</p>
<ul>
<li><strong>district_neighborhoods</strong>- gives the police district neighborhoods</li>
<li><strong>police_dist_id</strong>- this references the primary key of the philadelphia_police_boundaries</li>
<li><strong>station_id</strong>- this is the primary key of the police_station table and gives a unique number for each station</li>
<li><strong>geom</strong>- gives the geometry of each police_station</li>
<li><strong>location</strong>- has the location of each of the police_stations</li>
<li><strong>telephone</strong>- lists the phone number of each station</li>
</ul>
<p>The <strong>crime_incident</strong> table contains the following columns and information:</p>
<ul>
<li><strong>dc_key</strong>- a primary key for each crime that has been committed</li>
<li><strong>police_dist_id</strong>- this references the primary key of the philadelphia_police_boundaries</li>
<li><strong>crime_id</strong>- a code for each crime that is committed</li>
<li><strong>crime_dist</strong>- the district that each crime was committed in</li>
<li><strong>psa</strong>- police service area boundary</li>
<li><strong>crime_location</strong>- the approximate location of a crime</li>
<li><strong>dispatch_date</strong>- the date that a dispatch was sent out to a crime</li>
<li><strong>dispatch_time</strong>- the approximate time a dispatch was sent out to the location of a crime</li>
<li><strong>geom</strong>- the geometry of each crime</li>
</ul>
<p>The <strong>crime_districts</strong> table contains the following information:</p>
<ul>
<li><strong>dc_key</strong>- this references the primary key of the crime_incident table</li>
<li><strong>crime_district_id</strong>- this gives the table its own primary key and gives each district a unique number</li>
<li><strong>crime_district</strong>- this references the districts that had been used before the data set was updated</li>
</ul>
<p>The table <strong>ucr_text_genera</strong> contains the following columns and information:</p>
<ul>
<li><strong>dc_key</strong>- this references the primary key of the crime_incident table</li>
<li><strong>ucr_id</strong>- this is the primary key of the table</li>
<li><strong>ucr_genera</strong>- the rounded crime code for a particular crime that is committed</li>
<li><strong>text_gener</strong>- the text of the crime that was committed</li>
</ul>
<h2 id="end-of-tutorial">End of Tutorial</h2>
</div>
</body>

</html>
